<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport"
content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

<title>Sports TV</title>

<style>
body{
  margin:0;
  font-family:tahoma;
  background:#0b0b0b;
  color:#fff;
}

/* ===== Lock Screen ===== */
#lockScreen{
  position:fixed;
  inset:0;
  background:#080808;
  display:flex;
  justify-content:center;
  align-items:center;
  z-index:9999;
}

.lock-box{
  background:#121212;
  padding:25px;
  width:280px;
  border-radius:14px;
  text-align:center;
}

.lock-box input,
.lock-box button{
  width:100%;
  height:42px;
  border:none;
  border-radius:10px;
  margin-top:10px;
}

.lock-box input{
  padding:0 10px;
}

.lock-box button{
  background:#c90000;
  color:#fff;
  font-weight:bold;
}

/* ===== Telegram Card ===== */
.telegram-card{
  margin-top:15px;
  padding:12px;
  background:#0f1c24;
  border:1px solid #0088cc;
  border-radius:12px;
  font-size:14px;
}

.telegram-card a{
  display:block;
  margin-top:6px;
  color:#00aaff;
  font-weight:bold;
  text-decoration:none;
}

.telegram-card a:hover{
  text-decoration:underline;
}

#error{
  color:#ff4d4d;
  display:none;
  margin-top:10px;
}

#content{display:none}

/* ===== Header ===== */
.top-header{
  background:#111;
  padding:14px;
  text-align:center;
  border-bottom:2px solid #b30000;
}

.title{
  font-size:22px;
  font-weight:bold;
  text-shadow:0 0 6px #b30000;
}

.visits-box{
  margin-top:8px;
  background:#000;
  padding:10px;
  border-radius:12px;
  color:#00ff66;
  font-weight:bold;
}

/* ===== Iframe ===== */
.iframe-wrapper{
  position:relative;
  height:85vh;
}

.iframe-cover{
  position:absolute;
  top:0;
  left:0;
  width:100%;
  height:80px;
  background:#0b0b0b;
  z-index:10;
  pointer-events:none;
}

iframe{
  width:100vw;
  height:100vh;
  border:none;
}
</style>
</head>

<body>

<!-- ===== Lock Screen ===== -->
<div id="lockScreen">
  <div class="lock-box">
    <h3>ğŸ”’ Ø£Ø¯Ø®Ù„ ÙƒÙˆØ¯ Ø§Ù„Ø¯Ø®ÙˆÙ„</h3>

    <input id="lockCode" placeholder="Ø§Ù„ÙƒÙˆØ¯">

    <button onclick="unlock()">Ø¯Ø®ÙˆÙ„</button>

    <!-- Telegram Card -->
    <div class="telegram-card">
      Ø§Ù†Ø¶Ù… Ù„ÙŠÙ†Ø§ Ø¹Ù„Ù‰ ØªÙ„Ø¬Ø±Ø§Ù… Ù„ÙŠØµÙ„Ùƒ Ø£ÙƒÙˆØ§Ø¯ Ù…Ø¬Ø§Ù†ÙŠØ©
      <a href="https://t.me/spoortsTV" target="_blank">
        ğŸ”— Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø¥Ù„Ù‰ Ù‚Ù†Ø§Ø© Telegram
      </a>
    </div>

    <div id="error">ØªÙ… Ø¥ÙŠÙ‚Ø§Ù Ø£Ùˆ Ø­Ø°Ù Ø§Ù„ÙƒÙˆØ¯</div>
  </div>
</div>

<!-- ===== Content ===== -->
<div id="content">
  <div class="top-header">
    <div class="title">Sports TV</div>
    <div class="visits-box">
      ğŸ‘¤ <span id="userName">---</span><br>
      Ø¹Ø¯Ø¯ Ø§Ù„Ø²ÙŠØ§Ø±Ø§Øª: <span id="visitsCount">0</span>
    </div>
  </div>

  <div class="iframe-wrapper">
    <div class="iframe-cover"></div>
    <iframe src="https://www.fullmatch-hd.com/" allowfullscreen></iframe>
  </div>
</div>

<!-- ===== Firebase ===== -->
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>

<script>
const firebaseConfig = {
  apiKey: "AIzaSyAUc2cH9gVE7RECiW19XQXjNZQxVH96sFE",
  authDomain: "zezo-59a8d.firebaseapp.com",
  databaseURL: "https://zezo-59a8d-default-rtdb.firebaseio.com",
  projectId: "zezo-59a8d",
  storageBucket: "zezo-59a8d.appspot.com",
  messagingSenderId: "49183098248",
  appId: "1:49183098248:web:37e3fb16744042a1bb263d"
};

firebase.initializeApp(firebaseConfig);
const db = firebase.database();
const presenceRef = firebase.database().ref(".info/connected");

let currentCode = "";

function unlock(){
  const code = document.getElementById("lockCode").value.trim();
  if(!code) return;

  db.ref("codes/"+code).get().then(snap=>{
    if(!snap.exists()){showError();return;}
    const data = snap.val();
    if(!data.active || data.visits<=0){showError();return;}

    currentCode = code;
    db.ref("codes/"+code+"/visits").set(data.visits-1);

    document.getElementById("userName").innerText = data.name;
    document.getElementById("visitsCount").innerText = data.visits-1;

    document.getElementById("lockScreen").style.display="none";
    document.getElementById("content").style.display="block";

    const onlineRef = db.ref("codes/"+code+"/online");
    presenceRef.on("value",s=>{
      if(s.val()===true){
        onlineRef.set(true);
        onlineRef.onDisconnect().set(false);
      }
    });

    watchStatus();
  });
}

function watchStatus(){
  db.ref("codes/"+currentCode).on("value", snap=>{
    if(!snap.exists() || !snap.val().active || snap.val().visits<=0){
      logout();
      return;
    }
    document.getElementById("visitsCount").innerText = snap.val().visits;
  });
}

function logout(){
  if(currentCode){
    db.ref("codes/"+currentCode+"/online").set(false);
  }
  document.getElementById("content").style.display="none";
  document.getElementById("lockScreen").style.display="flex";
  document.getElementById("error").style.display="block";
}

function showError(){
  document.getElementById("error").style.display="block";
}
</script>

</body>
</html>
